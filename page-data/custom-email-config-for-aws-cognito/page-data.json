{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/custom-email-config-for-aws-cognito",
    "result": {"data":{"post":{"slug":"/custom-email-config-for-aws-cognito","title":"custom email config for AWS cognito","date":"30.03.2022","tags":[{"name":"AWS cognito","slug":"aws-cognito"}],"description":"custom email config for AWS cognito","canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"custom email config for AWS cognito\",\n  \"date\": \"2022-03-30T00:00:00.000Z\",\n  \"description\": \"custom email config for AWS cognito\",\n  \"tags\": [\"AWS cognito\"],\n  \"banner\": \"./brett-jordan-LPZy4da9aRo-unsplash.jpeg\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQME/9oADAMBAAIQAxAAAAHMahxsST0//8QAGhAAAgMBAQAAAAAAAAAAAAAAAQIAAxESE//aAAgBAQABBQKwBnenzAVsRHJOzqf/xAAXEQADAQAAAAAAAAAAAAAAAAAAAhEB/9oACAEDAQE/AVXaRT//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwFSf//EAB0QAAICAQUAAAAAAAAAAAAAAAABAhEhIjEyQXH/2gAIAQEABj8CjGkn3R6YG4rY1HI//8QAGxAAAwADAQEAAAAAAAAAAAAAAAERIUFxMfH/2gAIAQEAAT8hSbgAq7d0jJ8Y4UQbxw88khfVH//aAAwDAQACAAMAAAAQMw//xAAYEQEAAwEAAAAAAAAAAAAAAAABACEx8P/aAAgBAwEBPxBoTDZxc//EABYRAQEBAAAAAAAAAAAAAAAAAAEAIf/aAAgBAgEBPxAAjbf/xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhMVFhof/aAAgBAQABPxBaYGwprlnBqHH1IeD7j0ZfMMNgnTCEnYthYp5ggBUMBefZ/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Potions Class\",\n    \"title\": \"Potions Class\",\n    \"src\": \"/static/afe212df86c5145eacd7fd90dfdaad81/18e3b/brett-jordan-LPZy4da9aRo-unsplash.jpg\",\n    \"srcSet\": [\"/static/afe212df86c5145eacd7fd90dfdaad81/46946/brett-jordan-LPZy4da9aRo-unsplash.jpg 240w\", \"/static/afe212df86c5145eacd7fd90dfdaad81/55489/brett-jordan-LPZy4da9aRo-unsplash.jpg 480w\", \"/static/afe212df86c5145eacd7fd90dfdaad81/18e3b/brett-jordan-LPZy4da9aRo-unsplash.jpg 960w\", \"/static/afe212df86c5145eacd7fd90dfdaad81/60e21/brett-jordan-LPZy4da9aRo-unsplash.jpg 1440w\", \"/static/afe212df86c5145eacd7fd90dfdaad81/69b48/brett-jordan-LPZy4da9aRo-unsplash.jpg 1920w\", \"/static/afe212df86c5145eacd7fd90dfdaad81/640cf/brett-jordan-LPZy4da9aRo-unsplash.jpg 5184w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"div\", {\n    style: {\n      \"textAlign\": \"center\"\n    }\n  }, \"Photo by\", ' ', mdx(\"a\", {\n    href: \"https://unsplash.com/@brett_jordan?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\"\n  }, \"Brett Jordan\"), ' ', \"on\", ' ', mdx(\"a\", {\n    href: \"https://unsplash.com/s/photos/network?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\"\n  }, \"Unsplash\")), \"AWS SAM way to configure cognito custom email sender\", mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"add template yaml as following\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"AWSTemplateFormatVersion: '2010-09-09'\\nTransform: AWS::Serverless-2016-10-31\\nDescription: >-\\n  aws-sam-test bench template\\n\\nResources:\\n  CognitoFn:\\n    Type: 'AWS::Serverless::Function'\\n    Properties:\\n      FunctionName: aws-sam-testbench-cognito\\n      CodeUri: .\\n      Environment:\\n        Variables:\\n          KEY_ID: !GetAtt KmsKey.Arn\\n      Handler: dist/handlers/cognito.handler\\n      Runtime: nodejs14.x\\n      Policies:\\n        - KMSEncryptPolicy:\\n            KeyId: !Ref KmsKey\\n        - KMSDecryptPolicy:\\n            KeyId: !Ref KmsKey\\n      Architectures:\\n        - arm64\\n\\n  KmsKey:\\n    Type: AWS::KMS::Key\\n    Properties:\\n      Enabled: true\\n      KeyPolicy:\\n        Version: '2012-10-17'\\n        Statement:\\n          - Effect: Allow\\n            Principal:\\n              AWS: !Sub 'arn:aws:iam::211910070328:root'\\n            Action: 'kms:*'\\n            Resource: '*'\\n          - Effect: Allow\\n            Principal:\\n              AWS: !Sub 'arn:aws:iam::211910070328:user/canvs.service.1'\\n            Action:\\n              - 'kms:Create*'\\n              - 'kms:Describe*'\\n              - 'kms:Enable*'\\n              - 'kms:List*'\\n              - 'kms:Put*'\\n              - 'kms:Update*'\\n              - 'kms:Revoke*'\\n              - 'kms:Disable*'\\n              - 'kms:Get*'\\n              - 'kms:Delete*'\\n              - 'kms:TagResource'\\n              - 'kms:UntagResource'\\n              - 'kms:ScheduleKeyDeletion'\\n              - 'kms:CancelKeyDeletion'\\n            Resource: '*'\\n\")), mdx(\"p\", null, \"above deploying it will create lambda function and kms key\"), mdx(\"p\", null, \"since aws currently does not support assigning custom email sender function to cognito user pool via aws console dashboard, we need to do it manually via aws cli\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-custom-email-sender.html\"\n  }, \"read here\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"run script on local as following\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"aws lambda add-permission --function-name {lambda_arn} --statement-id \\\"CognitoLambdaInvokeAccess\\\" --action lambda:InvokeFunction --principal cognito-idp.amazonaws.com\\n\")), mdx(\"p\", null, \"eg\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"aws lambda add-permission --function-name \\\"arn:aws:lambda:ap-south-1:211910011111:function:aws-sam-testbench-cognito\\\" --statement-id \\\"CognitoLambdaInvokeAccess\\\" --action lambda:InvokeFunction --principal cognito-idp.amazonaws.com\\n\")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"update user pool with following\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"aws cognito-idp update-user-pool --user-pool-id {user_pool_id} --lambda-config \\\"CustomEmailSender={LambdaVersion=V1_0,LambdaArn={lambda-arn} },KMSKeyID={key-arn}\\\"\\n\")), mdx(\"p\", null, \"eg\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\"\n  }, \"aws cognito-idp update-user-pool --user-pool-id ap-south-1_DDTo62XXX --lambda-config \\\"CustomEmailSender={LambdaVersion=V1_0,LambdaArn= arn:aws:lambda:ap-south-1:2119100111111:function:aws-sam-testbench-cognito },KMSKeyID=arn:aws:kms:ap-south-1:21191001111:key/29c5dc17-8645-46ee-bi9w-efa82b52575d\\\"\\n\")), mdx(\"p\", null, \"ref -\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-custom-email-sender.html\"\n  }, \"https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-custom-email-sender.html\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://www.maxivanov.io/send-aws-cognito-emails-with-3rd-party-esps/\"\n  }, \"https://www.maxivanov.io/send-aws-cognito-emails-with-3rd-party-esps/\"))), mdx(\"p\", null, \"Note to configure - \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://stackoverflow.com/questions/67680510/cognito-does-not-call-lambda-function-in-customsmssender\"\n  }, \"https://stackoverflow.com/questions/67680510/cognito-does-not-call-lambda-function-in-customsmssender\")), mdx(\"span\", {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.16666666666667%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABvklEQVQoz52Sa47TMBSFs34khBBiIyCh2QFCsIOZaTtNmsR52vHbfXzIbhH8xtLnc2zLN1cnrrQxrFKyrhK1bTjnsP9BvmeMpdLacDq17PcHuq7Hh4D3Hud80bx2/uHz/j/qfMCF+PAeYy1V6U5Klsy60glBc2oZp7n4Ovt5pu16+mEo5L1pnlj6muW0Yxla5LYhlaLK06ntqJuGXgysamPTunwtaz7XWhefI1HqfjE3MQ6CUXRM44g2FmPMveDL647n51d2hzfqViDESNcJpmkunQ7jVFSqjRxRLp7VWFcKZf5EUllnCTFgrUEbjVxXhmFECIHRmuQtyRmi01xS4HJJnM93Uop4n3+IJcZQfCW1Q+rI/thzqAVSB5SJaJuYVODnUfHjTfL9INlNAWkS2p0Li3I0/UI7rEyrRdtApYxns4mmm6jbkbdG8HposS4iHHze3/h4uPF+D1+OiWb2iO1MPIP1l0K88FhHKh8818uFeZqYCmMJHG7IBJ+OVz7UV94drzz1Z6SJCB25cePvuPuUElUO1Fp3z20Y6XuB2jQpBhYTeGo83xrP19rzq3cMq2ZQllDe64MQCCGWB/4bOx35JrEyrJQAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"snapshot aws cognito\",\n    \"title\": \"snapshot aws cognito\",\n    \"src\": \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/7d769/snapshot-aws-cognito.png\",\n    \"srcSet\": [\"/static/694eb4cb8442a0e49a519a9f6ec1a29e/5243c/snapshot-aws-cognito.png 240w\", \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/ab158/snapshot-aws-cognito.png 480w\", \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/7d769/snapshot-aws-cognito.png 960w\", \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/87339/snapshot-aws-cognito.png 1440w\", \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/88b03/snapshot-aws-cognito.png 1920w\", \"/static/694eb4cb8442a0e49a519a9f6ec1a29e/e2bb3/snapshot-aws-cognito.png 2178w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"add template yaml as following above deploying it will create lambda function and kms key since aws currently does not support assigningâ€¦","timeToRead":1,"banner":{"childImageSharp":{"resize":{"src":"/static/afe212df86c5145eacd7fd90dfdaad81/a6c62/brett-jordan-LPZy4da9aRo-unsplash.jpg"}}}}},"pageContext":{"slug":"/custom-email-config-for-aws-cognito","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}